<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>59.0</apiVersion>
    <assignments>
        <name>Initialize_MasterOppt</name>
        <label>Initialize MasterOppt</label>
        <locationX>314</locationX>
        <locationY>350</locationY>
        <assignmentItems>
            <assignToReference>MasterOpportunity.CRM_Bisogno__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Estero</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>MasterOpportunity.RecordTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>RecordTypeEstero.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Creazione_Opportunity</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>sace_Assignment</name>
        <label>sace Assignment</label>
        <locationX>50</locationX>
        <locationY>890</locationY>
        <assignmentItems>
            <assignToReference>MasterOpportunity.Copertura_SACE_e_similari__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Opportunity</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>sace_assignment_no</name>
        <label>sace assignment no</label>
        <locationX>314</locationX>
        <locationY>890</locationY>
        <assignmentItems>
            <assignToReference>MasterOpportunity.Copertura_SACE_e_similari__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Opportunity</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>SetMasterOpp</name>
        <label>SetMasterOpp</label>
        <locationX>314</locationX>
        <locationY>674</locationY>
        <assignmentItems>
            <assignToReference>MasterOpportunity.Name</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>NomeOpportunity</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>MasterOpportunity.StageName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Fase</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>MasterOpportunity.CloseDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Data_Chiusura</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>MasterOpportunity.Desk__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Desk</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>MasterOpportunity.Importo_operazione_di_mercato_Size__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>ImportoOperazioneDiMercato</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>MasterOpportunity.Commissione__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Commissioni</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>MasterOpportunity.Valuta__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Valuta</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>MasterOpportunity.Note__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>NoteLong</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>MasterOpportunity.CRM_EsitoContatto__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>-</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>MasterOpportunity.AccountId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>GetNdg.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>MasterOpportunity.Informazioni_Privilegiate__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>No</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>MasterOpportunity.CIB_Nome_Opportunita__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>NomeOpportunity</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>MasterOpportunity.Probabilita_di_successo__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Probabilit_di_successo</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>MasterOpportunity.CRM_Oggetto__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>FormulaOggetto_TipoOperazione</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>checkSace</targetReference>
        </connector>
    </assignments>
    <choices>
        <name>EUR</name>
        <choiceText>EUR</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>EUR</stringValue>
        </value>
    </choices>
    <choices>
        <name>GBT_Estero</name>
        <choiceText>GTB estero</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>GTB estero</stringValue>
        </value>
    </choices>
    <choices>
        <name>In_valutazione</name>
        <choiceText>In valutazione</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>In valutazione</stringValue>
        </value>
    </choices>
    <choices>
        <name>No</name>
        <choiceText>No</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>No</stringValue>
        </value>
    </choices>
    <choices>
        <name>Si</name>
        <choiceText>Si</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Si</stringValue>
        </value>
    </choices>
    <choices>
        <name>USD</name>
        <choiceText>USD</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>USD</stringValue>
        </value>
    </choices>
    <choices>
        <name>X10</name>
        <choiceText>10%</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>10%</stringValue>
        </value>
    </choices>
    <choices>
        <name>X100</name>
        <choiceText>100%</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>100%</stringValue>
        </value>
    </choices>
    <choices>
        <name>X25</name>
        <choiceText>25%</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>25%</stringValue>
        </value>
    </choices>
    <choices>
        <name>X50</name>
        <choiceText>50%</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>50%</stringValue>
        </value>
    </choices>
    <choices>
        <name>X75</name>
        <choiceText>75%</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>75%</stringValue>
        </value>
    </choices>
    <choices>
        <name>X90</name>
        <choiceText>90%</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>90%</stringValue>
        </value>
    </choices>
    <decisions>
        <name>checkSace</name>
        <label>checkSace</label>
        <locationX>314</locationX>
        <locationY>782</locationY>
        <defaultConnector>
            <targetReference>Create_Opportunity</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Copertura_SACE_e_similari</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>Si</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>sace_Assignment</targetReference>
            </connector>
            <label>yes</label>
        </rules>
        <rules>
            <name>noCheck</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Copertura_SACE_e_similari</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>No</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>sace_assignment_no</targetReference>
            </connector>
            <label>no</label>
        </rules>
    </decisions>
    <description>v6 - Inserimento campo Tipo Operazione + run as system</description>
    <environments>Default</environments>
    <formulas>
        <name>Formula_CurrentCustomerName</name>
        <dataType>String</dataType>
        <expression>IF (
{!GetNdg.RecordType.DeveloperName} = &apos;PersonAccount&apos;,
{!GetNdg.FirstName} + &quot; &quot; + {!GetNdg.LastName},
{!GetNdg.Name}
)</expression>
    </formulas>
    <formulas>
        <name>FormulaDate</name>
        <dataType>Boolean</dataType>
        <expression>{!Data_Chiusura} &gt;=TODAY()</expression>
    </formulas>
    <formulas>
        <name>FormulaOggetto_TipoOperazione</name>
        <dataType>String</dataType>
        <expression>IF(NOT(ISBLANK(TEXT({!MasterOpportunity.Tipo_Operazione__c}))),
TEXT({!MasterOpportunity.Tipo_Operazione__c}),
null
)</expression>
    </formulas>
    <interviewLabel>Creazione Opportunità Estero {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Creazione Opportunità Estero</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <recordCreates>
        <name>Create_Opportunity</name>
        <label>Create Opportunity</label>
        <locationX>314</locationX>
        <locationY>1082</locationY>
        <connector>
            <targetReference>Success_Screen</targetReference>
        </connector>
        <inputReference>MasterOpportunity</inputReference>
    </recordCreates>
    <recordLookups>
        <name>Get_RT_Id</name>
        <label>Get RT Id</label>
        <locationX>314</locationX>
        <locationY>242</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Initialize_MasterOppt</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Estero</stringValue>
            </value>
        </filters>
        <object>RecordType</object>
        <outputReference>RecordTypeEstero</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>DeveloperName</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>GetNdg</name>
        <label>GetNdg</label>
        <locationX>314</locationX>
        <locationY>134</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_RT_Id</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Account</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <runInMode>SystemModeWithoutSharing</runInMode>
    <screens>
        <name>Creazione_Opportunity</name>
        <label>Creazione Opportunity</label>
        <locationX>314</locationX>
        <locationY>458</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <backButtonLabel>Indietro</backButtonLabel>
        <connector>
            <targetReference>Note</targetReference>
        </connector>
        <fields>
            <name>Testata</name>
            <fieldText>&lt;p&gt;&lt;strong style=&quot;font-size: 16px;&quot;&gt;Testata&lt;/strong&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Creazione_Opportunity_Section1</name>
            <fieldType>RegionContainer</fieldType>
            <fields>
                <name>Creazione_Opportunity_Section1_Column1</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>NomeOpportunity</name>
                    <dataType>String</dataType>
                    <fieldText>Nome Opportunità</fieldText>
                    <fieldType>InputField</fieldType>
                    <isRequired>true</isRequired>
                </fields>
                <fields>
                    <name>name</name>
                    <fieldText>&lt;p&gt;Nome Account: &lt;/p&gt;&lt;p&gt;{!GetNdg.Name}&lt;/p&gt;</fieldText>
                    <fieldType>DisplayText</fieldType>
                </fields>
                <fields>
                    <name>Fase</name>
                    <choiceReferences>In_valutazione</choiceReferences>
                    <dataType>String</dataType>
                    <defaultSelectedChoiceReference>In_valutazione</defaultSelectedChoiceReference>
                    <fieldText>Fase</fieldText>
                    <fieldType>DropdownBox</fieldType>
                    <isRequired>true</isRequired>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>6</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <fields>
                <name>Creazione_Opportunity_Section1_Column2</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>Probabilit_di_successo</name>
                    <choiceReferences>X10</choiceReferences>
                    <choiceReferences>X25</choiceReferences>
                    <choiceReferences>X50</choiceReferences>
                    <choiceReferences>X75</choiceReferences>
                    <choiceReferences>X90</choiceReferences>
                    <choiceReferences>X100</choiceReferences>
                    <dataType>String</dataType>
                    <fieldText>Probabilità di successo</fieldText>
                    <fieldType>DropdownBox</fieldType>
                    <isRequired>true</isRequired>
                </fields>
                <fields>
                    <name>Data_Chiusura</name>
                    <dataType>Date</dataType>
                    <fieldText>Data Chiusura</fieldText>
                    <fieldType>InputField</fieldType>
                    <isRequired>true</isRequired>
                    <validationRule>
                        <errorMessage>&lt;p&gt;&lt;span style=&quot;color: rgb(255, 0, 0);&quot;&gt;La data non può essere inferiore alla data odierna&lt;/span&gt;&lt;/p&gt;</errorMessage>
                        <formulaExpression>{!FormulaDate}</formulaExpression>
                    </validationRule>
                </fields>
                <fields>
                    <name>Desk</name>
                    <choiceReferences>GBT_Estero</choiceReferences>
                    <dataType>String</dataType>
                    <defaultSelectedChoiceReference>GBT_Estero</defaultSelectedChoiceReference>
                    <fieldText>Desk</fieldText>
                    <fieldType>DropdownBox</fieldType>
                    <isRequired>true</isRequired>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>6</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <isRequired>false</isRequired>
            <regionContainerType>SectionWithoutHeader</regionContainerType>
        </fields>
        <nextOrFinishButtonLabel>Avanti</nextOrFinishButtonLabel>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Note</name>
        <label>Note</label>
        <locationX>314</locationX>
        <locationY>566</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <backButtonLabel>Indietro</backButtonLabel>
        <connector>
            <targetReference>SetMasterOpp</targetReference>
        </connector>
        <fields>
            <name>Economics</name>
            <fieldText>&lt;p&gt;&lt;strong style=&quot;background-color: rgb(255, 255, 255); color: rgb(68, 68, 68);&quot;&gt;Economics&lt;/strong&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Note_Section1</name>
            <fieldType>RegionContainer</fieldType>
            <fields>
                <name>Note_Section1_Column1</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>Valuta</name>
                    <choiceReferences>EUR</choiceReferences>
                    <choiceReferences>USD</choiceReferences>
                    <dataType>String</dataType>
                    <fieldText>Valuta</fieldText>
                    <fieldType>DropdownBox</fieldType>
                    <isRequired>false</isRequired>
                </fields>
                <fields>
                    <name>ImportoOperazioneDiMercato</name>
                    <dataType>Number</dataType>
                    <fieldText>Importo Operazione Di Mercato (Size)</fieldText>
                    <fieldType>InputField</fieldType>
                    <isRequired>false</isRequired>
                    <scale>0</scale>
                </fields>
                <fields>
                    <name>Commissioni</name>
                    <dataType>Number</dataType>
                    <fieldText>Commissioni</fieldText>
                    <fieldType>InputField</fieldType>
                    <isRequired>false</isRequired>
                    <scale>0</scale>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>6</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <fields>
                <name>Note_Section1_Column2</name>
                <fieldType>Region</fieldType>
                <fields>
                    <fieldType>ObjectProvided</fieldType>
                    <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
                    <isRequired>false</isRequired>
                    <objectFieldReference>MasterOpportunity.Tipo_Operazione__c</objectFieldReference>
                </fields>
                <fields>
                    <name>Copertura_SACE_e_similari</name>
                    <choiceReferences>Si</choiceReferences>
                    <choiceReferences>No</choiceReferences>
                    <dataType>String</dataType>
                    <fieldText>Copertura SACE e similari</fieldText>
                    <fieldType>RadioButtons</fieldType>
                    <isRequired>false</isRequired>
                </fields>
                <fields>
                    <name>NoteLong</name>
                    <fieldText>Note</fieldText>
                    <fieldType>LargeTextArea</fieldType>
                    <isRequired>false</isRequired>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>6</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <isRequired>false</isRequired>
            <regionContainerType>SectionWithoutHeader</regionContainerType>
        </fields>
        <nextOrFinishButtonLabel>Avanti</nextOrFinishButtonLabel>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Success_Screen</name>
        <label>Success Screen</label>
        <locationX>314</locationX>
        <locationY>1190</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>Success_Screen_Section1</name>
            <fieldType>RegionContainer</fieldType>
            <fields>
                <name>Success_Screen_Section1_Column1</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>SuccessImage_0</name>
                    <extensionName>flowruntime:image</extensionName>
                    <fieldType>ComponentInstance</fieldType>
                    <inputParameters>
                        <name>imageName</name>
                        <value>
                            <stringValue>success_icon</stringValue>
                        </value>
                    </inputParameters>
                    <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
                    <isRequired>true</isRequired>
                    <storeOutputAutomatically>true</storeOutputAutomatically>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>1</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <fields>
                <name>Success_Screen_Section1_Column2</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>SuccessMsg</name>
                    <fieldText>&lt;p&gt;&lt;strong style=&quot;background-color: rgb(255, 255, 255); color: rgb(0, 81, 87); font-size: 16px;&quot;&gt;Opportunità Estero inserita con successo per NDG {!GetNdg.CRM_NDG__c}&lt;/strong&gt;&lt;/p&gt;</fieldText>
                    <fieldType>DisplayText</fieldType>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>11</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <isRequired>false</isRequired>
            <regionContainerType>SectionWithoutHeader</regionContainerType>
        </fields>
        <nextOrFinishButtonLabel>Fine</nextOrFinishButtonLabel>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <start>
        <locationX>188</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>GetNdg</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <variables>
        <name>MasterOpportunity</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Opportunity</objectType>
    </variables>
    <variables>
        <name>recordId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>RecordTypeEstero</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>RecordType</objectType>
    </variables>
</Flow>
