<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>59.0</apiVersion>
    <assignments>
        <name>AssignCF</name>
        <label>AssignCF</label>
        <locationX>314</locationX>
        <locationY>458</locationY>
        <assignmentItems>
            <assignToReference>GetOpportunity.StageName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>FaseCF</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>GetOpportunity.CIB_Stato_opportunita_SF__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Stato_opportunitaCF</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>UpdateOpportunity</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>AssignE</name>
        <label>AssignE</label>
        <locationX>1238</locationX>
        <locationY>758</locationY>
        <assignmentItems>
            <assignToReference>GetOpportunity.StageName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>FaseE</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>GetOpportunity.CIB_Stato_opportunita_SF__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Stato_opportunitaE</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>UpdateOpportunity</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>AssignLS</name>
        <label>AssignLS</label>
        <locationX>842</locationX>
        <locationY>458</locationY>
        <assignmentItems>
            <assignToReference>GetOpportunity.StageName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>FaseLS</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>GetOpportunity.CIB_Stato_opportunita_SF__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Stato_opportunitaLS</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>UpdateOpportunity</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>AssignSF</name>
        <label>AssignSF</label>
        <locationX>50</locationX>
        <locationY>458</locationY>
        <assignmentItems>
            <assignToReference>GetOpportunity.StageName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>FaseSF</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>GetOpportunity.CIB_Stato_opportunita_SF__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Stato_opportunitaSF</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>UpdateOpportunity</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>AssignTB</name>
        <label>AssignTB</label>
        <locationX>578</locationX>
        <locationY>458</locationY>
        <assignmentItems>
            <assignToReference>GetOpportunity.StageName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>FaseTB</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>GetOpportunity.CIB_Stato_opportunita_SF__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Stato_opportunitaTB</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>UpdateOpportunity</targetReference>
        </connector>
    </assignments>
    <choices>
        <name>AbbandonatadalCliente</name>
        <choiceText>Abbandonata dal Cliente</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Abbandonata dal Cliente</stringValue>
        </value>
    </choices>
    <choices>
        <name>AbbandonatadalDesk</name>
        <choiceText>Abbandonata dal Desk</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Abbandonata dal Desk</stringValue>
        </value>
    </choices>
    <choices>
        <name>Chiusa</name>
        <choiceText>Chiusa</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Chiusa</stringValue>
        </value>
    </choices>
    <choices>
        <name>ChiusaPersa</name>
        <choiceText>Chiusa/Persa</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Chiusa/Persa</stringValue>
        </value>
    </choices>
    <choices>
        <name>DeclinatadaCIBCommittee</name>
        <choiceText>Declinata da CIB Committee</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Declinata da CIB Committee</stringValue>
        </value>
    </choices>
    <choices>
        <name>DeclinatadalCredito</name>
        <choiceText>Declinata dal Credito</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Declinata dal Credito</stringValue>
        </value>
    </choices>
    <choices>
        <name>DeclinatadalTavoloIBCommittee</name>
        <choiceText>Declinata dal Tavolo IB Committee</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Declinata dal Tavolo IB Committee</stringValue>
        </value>
    </choices>
    <choices>
        <name>FasePECSdifusione</name>
        <choiceText>Fase PECS di fusione</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Fase PECS di fusione</stringValue>
        </value>
    </choices>
    <choices>
        <name>Mandatochiusosenzasuccesso</name>
        <choiceText>Mandato chiuso senza successo</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Mandato chiuso senza successo</stringValue>
        </value>
    </choices>
    <choices>
        <name>Mandatoperso</name>
        <choiceText>Mandato perso</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Mandato perso</stringValue>
        </value>
    </choices>
    <choices>
        <name>Persapercompetizione</name>
        <choiceText>Persa per competizione</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Persa per competizione</stringValue>
        </value>
    </choices>
    <decisions>
        <name>Check_Motivo_Chiusura</name>
        <label>Check Motivo Chiusura</label>
        <locationX>1238</locationX>
        <locationY>458</locationY>
        <defaultConnector>
            <targetReference>AssignE</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>is_null</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>GetOpportunity.CRM_Motivo_di_chiusura__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Screen_Motivo_chiusura_null</targetReference>
            </connector>
            <label>is null</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_Record_Type</name>
        <label>Check Record Type</label>
        <locationX>798</locationX>
        <locationY>242</locationY>
        <defaultConnector>
            <targetReference>UpdateOpportunity</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Structured_Finance</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>GetOpportunity.RecordTypeName__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Structured Finance</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>viewSF</targetReference>
            </connector>
            <label>Structured Finance</label>
        </rules>
        <rules>
            <name>Corporate_Finance</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>GetOpportunity.RecordTypeName__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Corporate Finance</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>viewCF</targetReference>
            </connector>
            <label>Corporate Finance</label>
        </rules>
        <rules>
            <name>Traditional_Banking</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>GetOpportunity.RecordTypeName__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Traditional Banking</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>viewTB</targetReference>
            </connector>
            <label>Traditional Banking</label>
        </rules>
        <rules>
            <name>Leasing</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>GetOpportunity.RecordTypeName__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Leasing</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>viewLS</targetReference>
            </connector>
            <label>Leasing</label>
        </rules>
        <rules>
            <name>Estero</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>GetOpportunity.RecordTypeName__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Estero</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>viewE</targetReference>
            </connector>
            <label>Estero</label>
        </rules>
    </decisions>
    <environments>Default</environments>
    <interviewLabel>CIB Chiusura Opportunità {!$Flow.CurrentDateTime}</interviewLabel>
    <isAdditionalPermissionRequiredToRun>true</isAdditionalPermissionRequiredToRun>
    <label>CIB Chiusura Opportunità</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <recordLookups>
        <name>GetOpportunity</name>
        <label>GetOpportunity</label>
        <locationX>798</locationX>
        <locationY>134</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Check_Record_Type</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Opportunity</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>UpdateOpportunity</name>
        <label>UpdateOpportunity</label>
        <locationX>798</locationX>
        <locationY>950</locationY>
        <inputReference>GetOpportunity</inputReference>
    </recordUpdates>
    <screens>
        <name>Screen_Motivo_chiusura_null</name>
        <label>Screen Motivo chiusura null</label>
        <locationX>1106</locationX>
        <locationY>566</locationY>
        <allowBack>true</allowBack>
        <allowFinish>false</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>AssignE</targetReference>
        </connector>
        <fields>
            <name>displaymotivo</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;color: rgb(255, 0, 0);&quot;&gt;Per proseguire è necessario valorizzare Motivo di Chiusura.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>viewCF</name>
        <label>viewCF</label>
        <locationX>314</locationX>
        <locationY>350</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>AssignCF</targetReference>
        </connector>
        <fields>
            <name>FaseCF</name>
            <choiceReferences>Chiusa</choiceReferences>
            <dataType>String</dataType>
            <defaultSelectedChoiceReference>Chiusa</defaultSelectedChoiceReference>
            <fieldText>Fase</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>Stato_opportunitaCF</name>
            <choiceReferences>AbbandonatadalDesk</choiceReferences>
            <choiceReferences>AbbandonatadalCliente</choiceReferences>
            <choiceReferences>DeclinatadaCIBCommittee</choiceReferences>
            <choiceReferences>Mandatochiusosenzasuccesso</choiceReferences>
            <choiceReferences>Mandatoperso</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Stato opportunità</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <nextOrFinishButtonLabel>Salva</nextOrFinishButtonLabel>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>viewE</name>
        <label>viewE</label>
        <locationX>1238</locationX>
        <locationY>350</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Check_Motivo_Chiusura</targetReference>
        </connector>
        <fields>
            <name>FaseE</name>
            <choiceReferences>Chiusa</choiceReferences>
            <dataType>String</dataType>
            <defaultSelectedChoiceReference>Chiusa</defaultSelectedChoiceReference>
            <fieldText>Fase</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>Stato_opportunitaE</name>
            <choiceReferences>ChiusaPersa</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Stato opportunità</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <fieldType>ObjectProvided</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>false</isRequired>
            <objectFieldReference>GetOpportunity.CRM_Motivo_di_chiusura__c</objectFieldReference>
        </fields>
        <nextOrFinishButtonLabel>Salva</nextOrFinishButtonLabel>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>viewLS</name>
        <label>viewLS</label>
        <locationX>842</locationX>
        <locationY>350</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>AssignLS</targetReference>
        </connector>
        <fields>
            <name>FaseLS</name>
            <choiceReferences>Chiusa</choiceReferences>
            <dataType>String</dataType>
            <defaultSelectedChoiceReference>Chiusa</defaultSelectedChoiceReference>
            <fieldText>Fase</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>Stato_opportunitaLS</name>
            <choiceReferences>AbbandonatadalDesk</choiceReferences>
            <choiceReferences>AbbandonatadalCliente</choiceReferences>
            <choiceReferences>DeclinatadalCredito</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Stato opportunità</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <nextOrFinishButtonLabel>Salva</nextOrFinishButtonLabel>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>viewSF</name>
        <label>viewSF</label>
        <locationX>50</locationX>
        <locationY>350</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>AssignSF</targetReference>
        </connector>
        <fields>
            <name>FaseSF</name>
            <choiceReferences>Chiusa</choiceReferences>
            <dataType>String</dataType>
            <defaultSelectedChoiceReference>Chiusa</defaultSelectedChoiceReference>
            <fieldText>Fase</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>Stato_opportunitaSF</name>
            <choiceReferences>AbbandonatadalDesk</choiceReferences>
            <choiceReferences>AbbandonatadalCliente</choiceReferences>
            <choiceReferences>DeclinatadaCIBCommittee</choiceReferences>
            <choiceReferences>Persapercompetizione</choiceReferences>
            <choiceReferences>DeclinatadalCredito</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Stato opportunità</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <nextOrFinishButtonLabel>Salva</nextOrFinishButtonLabel>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>viewTB</name>
        <label>viewTB</label>
        <locationX>578</locationX>
        <locationY>350</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>AssignTB</targetReference>
        </connector>
        <fields>
            <name>FaseTB</name>
            <choiceReferences>Chiusa</choiceReferences>
            <dataType>String</dataType>
            <defaultSelectedChoiceReference>Chiusa</defaultSelectedChoiceReference>
            <fieldText>Fase</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>Stato_opportunitaTB</name>
            <choiceReferences>AbbandonatadalDesk</choiceReferences>
            <choiceReferences>AbbandonatadalCliente</choiceReferences>
            <choiceReferences>DeclinatadalCredito</choiceReferences>
            <choiceReferences>DeclinatadalTavoloIBCommittee</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Stato opportunità</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <nextOrFinishButtonLabel>Salva</nextOrFinishButtonLabel>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <start>
        <locationX>672</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>GetOpportunity</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <variables>
        <name>recordId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
