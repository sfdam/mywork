<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>52.0</apiVersion>
    <assignments>
        <name>Add_to_contatti</name>
        <label>Add to contatti</label>
        <locationX>215</locationX>
        <locationY>1139</locationY>
        <assignmentItems>
            <assignToReference>Contatti</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_clean_contatti</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_clean_contatti</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_email_1</name>
        <label>Set email 1</label>
        <locationX>1393</locationX>
        <locationY>1648</locationY>
        <assignmentItems>
            <assignToReference>appointmentEmail</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>ReferenteImpresa.Email</elementReference>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Set_email_2</name>
        <label>Set email 2</label>
        <locationX>618</locationX>
        <locationY>1858</locationY>
        <assignmentItems>
            <assignToReference>appointmentEmail</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Formula_ContactEmail</elementReference>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Set_email_3</name>
        <label>Set email 3</label>
        <locationX>113</locationX>
        <locationY>1680</locationY>
        <assignmentItems>
            <assignToReference>appointmentEmail</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Referente_Impresa_selezionato.Email</elementReference>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Set_email_privato</name>
        <label>Set email privato</label>
        <locationX>10</locationX>
        <locationY>672</locationY>
        <assignmentItems>
            <assignToReference>appointmentEmail</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Formula_ContactEmail</elementReference>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Set_ids</name>
        <label>Set ids</label>
        <locationX>843</locationX>
        <locationY>1116</locationY>
        <assignmentItems>
            <assignToReference>List_ReferentiImpresa_Ids</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_over_referenti_d_impresa.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_over_referenti_d_impresa</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_ids_length</name>
        <label>Set ids length</label>
        <locationX>616</locationX>
        <locationY>1320</locationY>
        <assignmentItems>
            <assignToReference>ReferentiImpresa_Size</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>List_ReferentiImpresa_Ids</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Email_screen_Privato_0</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_labels</name>
        <label>Set labels</label>
        <locationX>608</locationX>
        <locationY>969</locationY>
        <assignmentItems>
            <assignToReference>List_ReferentiImpresa_Labels</assignToReference>
            <operator>Add</operator>
            <value>
                <stringValue>Name</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>List_ReferentiImpresa_Labels</assignToReference>
            <operator>Add</operator>
            <value>
                <stringValue>Email</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>List_ReferentiImpresa_Labels</assignToReference>
            <operator>Add</operator>
            <value>
                <stringValue>Phone</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>List_ReferentiImpresa_Labels</assignToReference>
            <operator>Add</operator>
            <value>
                <stringValue>CRM_Ambito__c</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_over_referenti_d_impresa</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_nuovo_referente_impresa</name>
        <label>Set nuovo referente impresa</label>
        <locationX>870</locationX>
        <locationY>1650</locationY>
        <assignmentItems>
            <assignToReference>ReferenteImpresa.RecordTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_RT_referenti_d_impresa.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>ReferenteImpresa.AccountId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>ReferenteImpresa.FirstName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>NomeRefImpresa</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>ReferenteImpresa.LastName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CognomeRefImpresa</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>ReferenteImpresa.Email</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>EmailRefImpresa.value</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>ReferenteImpresa.Phone</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>PhoneRefImpresa.value</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>ReferenteImpresa.MobilePhone</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>MobileRefImpresa.value</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>ReferenteImpresa.CRM_Ambito__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>AmbitoRefImpresa</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>ReferenteImpresa.CRM_NDGReferenteImpresa__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>NDGRefImpresa</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Insert_referente_d_impresa</targetReference>
        </connector>
    </assignments>
    <choices>
        <name>NuovoRefImpresa_NO</name>
        <choiceText>NO</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>NO</stringValue>
        </value>
    </choices>
    <choices>
        <name>NuovoRefImpresa_SI</name>
        <choiceText>SI</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>SI</stringValue>
        </value>
    </choices>
    <choices>
        <name>Option_ClienteHaEmail_No</name>
        <choiceText>No</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>No</stringValue>
        </value>
    </choices>
    <choices>
        <name>Option_ClienteHaEmail_Si</name>
        <choiceText>Sì</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Sì</stringValue>
        </value>
    </choices>
    <choices>
        <name>Option_EmailCorretta_No</name>
        <choiceText>No</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>No</stringValue>
        </value>
    </choices>
    <choices>
        <name>Option_EmailCorretta_Si</name>
        <choiceText>Sì</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Sì</stringValue>
        </value>
    </choices>
    <decisions>
        <name>Check_choices</name>
        <label>Check choices</label>
        <locationX>603</locationX>
        <locationY>1649</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Nuovo_referente_impresa</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>OpzioniReferentiImpresa</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>NuovoRefImpresa_SI</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_nuovo_referente_impresa</targetReference>
            </connector>
            <label>Nuovo referente impresa</label>
        </rules>
        <rules>
            <name>Indirizzo_corretto</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>OpzioniImpresa</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>Option_EmailCorretta_Si</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_email_2</targetReference>
            </connector>
            <label>Indirizzo corretto</label>
        </rules>
        <rules>
            <name>Referente_Impresa_selezionato</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>ReferentiImpresa.selectedRecordId</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Referente_Impresa_selezionato</targetReference>
            </connector>
            <label>Referente Impresa selezionato</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_if_email_empty</name>
        <label>Check if email empty</label>
        <locationX>61</locationX>
        <locationY>878</locationY>
        <defaultConnector>
            <targetReference>Add_to_contatti</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Not empty</defaultConnectorLabel>
        <rules>
            <name>Empty</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Loop_clean_contatti.Email</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Loop_clean_contatti</targetReference>
            </connector>
            <label>Empty</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_risposta_privato</name>
        <label>Check risposta privato</label>
        <locationX>244</locationX>
        <locationY>587</locationY>
        <defaultConnectorLabel>Email non corretta</defaultConnectorLabel>
        <rules>
            <name>Email_corretta</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>OpzioniPrivato</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>Option_EmailCorretta_Si</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_email_privato</targetReference>
            </connector>
            <label>Email corretta</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_tipo_cliente</name>
        <label>Check tipo cliente</label>
        <locationX>612</locationX>
        <locationY>457</locationY>
        <defaultConnectorLabel>Altro</defaultConnectorLabel>
        <rules>
            <name>Impresa</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_NDG.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>IndustriesBusiness</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_RT_referenti_d_impresa</targetReference>
            </connector>
            <label>Impresa</label>
        </rules>
        <rules>
            <name>Privato</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_NDG.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>PersonAccount</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Email_screen_Privato</targetReference>
            </connector>
            <label>Privato</label>
        </rules>
    </decisions>
    <formulas>
        <name>Formula_ContactEmail</name>
        <dataType>String</dataType>
        <expression>IF(!ISBLANK({!Get_NDG.CRM_SmartWebEmail__c}), {!Get_NDG.CRM_SmartWebEmail__c}, NULL)</expression>
    </formulas>
    <interviewLabel>Nuovo appuntamento - Scheduler - Inserimento email cliente v2 {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Nuovo appuntamento - Scheduler - Inserimento email cliente v2</label>
    <loops>
        <name>Loop_clean_contatti</name>
        <label>Loop clean contatti</label>
        <locationX>373</locationX>
        <locationY>887</locationY>
        <collectionReference>Get_referenti_d_impresa</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Check_if_email_empty</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Set_labels</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_over_referenti_d_impresa</name>
        <label>Loop over referenti d&apos;impresa</label>
        <locationX>615</locationX>
        <locationY>1110</locationY>
        <collectionReference>Contatti</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Set_ids</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Set_ids_length</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processType>Appointments</processType>
    <recordCreates>
        <name>Insert_referente_d_impresa</name>
        <label>Insert referente d&apos;impresa</label>
        <locationX>1125</locationX>
        <locationY>1649</locationY>
        <connector>
            <targetReference>Set_email_1</targetReference>
        </connector>
        <inputReference>ReferenteImpresa</inputReference>
    </recordCreates>
    <recordLookups>
        <name>Get_NDG</name>
        <label>Get NDG</label>
        <locationX>281</locationX>
        <locationY>337</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Check_tipo_cliente</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Account</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Referente_Impresa_selezionato</name>
        <label>Get Referente Impresa selezionato</label>
        <locationX>297</locationX>
        <locationY>1664</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Set_email_3</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>ReferentiImpresa.selectedRecordId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contact</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_referenti_d_impresa</name>
        <label>Get referenti d&apos;impresa</label>
        <locationX>607</locationX>
        <locationY>807</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Loop_clean_contatti</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>AccountId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_NDG.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>RecordTypeId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_RT_referenti_d_impresa.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Contact</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_RT_referenti_d_impresa</name>
        <label>Get RT referenti d&apos;impresa</label>
        <locationX>621</locationX>
        <locationY>643</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_referenti_d_impresa</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Referente_Impresa</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>RecordType</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <runInMode>SystemModeWithoutSharing</runInMode>
    <screens>
        <name>Email_screen_Privato</name>
        <label>Email screen Privato</label>
        <locationX>420</locationX>
        <locationY>574</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Check_risposta_privato</targetReference>
        </connector>
        <fields>
            <name>Title1</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;font-size: 16px; color: rgb(8, 7, 7);&quot;&gt;Per concludere, verrà inviato al cliente un promemoria per l&apos;appuntamento.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Email_screen_Privato_Section1</name>
            <fieldType>RegionContainer</fieldType>
            <fields>
                <name>Email_screen_Privato_Section1_Column1</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>Case21</name>
                    <fieldText>&lt;p&gt;&lt;span style=&quot;font-size: 16px; color: rgb(8, 7, 7);&quot;&gt;Si desidera utilizzare il seguente indirizzo email?&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 16px; color: rgb(8, 7, 7);&quot;&gt;{!Formula_ContactEmail}&lt;/span&gt;&lt;/p&gt;</fieldText>
                    <fieldType>DisplayText</fieldType>
                </fields>
                <fields>
                    <name>OpzioniPrivato</name>
                    <choiceReferences>Option_EmailCorretta_Si</choiceReferences>
                    <choiceReferences>Option_EmailCorretta_No</choiceReferences>
                    <dataType>String</dataType>
                    <fieldText>Seleziona un valore</fieldText>
                    <fieldType>RadioButtons</fieldType>
                    <isRequired>false</isRequired>
                </fields>
                <fields>
                    <name>Case31</name>
                    <fieldText>&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(62, 62, 60);&quot;&gt;Si consiglia di aggiornare l&apos;informazione in Anagrafe e successivamente di riavviare la procedura.&lt;/span&gt;&lt;/p&gt;</fieldText>
                    <fieldType>DisplayText</fieldType>
                    <visibilityRule>
                        <conditionLogic>and</conditionLogic>
                        <conditions>
                            <leftValueReference>OpzioniPrivato</leftValueReference>
                            <operator>EqualTo</operator>
                            <rightValue>
                                <elementReference>Option_EmailCorretta_No</elementReference>
                            </rightValue>
                        </conditions>
                    </visibilityRule>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>12</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <isRequired>false</isRequired>
            <regionContainerType>SectionWithoutHeader</regionContainerType>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>Formula_ContactEmail</leftValueReference>
                    <operator>IsNull</operator>
                    <rightValue>
                        <booleanValue>false</booleanValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>Title2</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;color: rgb(8, 7, 7); font-size: 16px; font-family: var(--lwc-fontFamily,-apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Helvetica, Arial, sans-serif, &amp;quot;Apple Color Emoji&amp;quot;, &amp;quot;Segoe UI Emoji&amp;quot;, &amp;quot;Segoe UI Symbol&amp;quot;);&quot;&gt;Non risulta presente alcun indirizzo email certificato associato al cliente, di conseguenza si consiglia di aggiornare prima l&apos;informazione in Anagrafe e successivamente di riavviare la procedura.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>Formula_ContactEmail</leftValueReference>
                    <operator>IsNull</operator>
                    <rightValue>
                        <booleanValue>true</booleanValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Email_screen_Privato_0</name>
        <label>Email screen Privato</label>
        <locationX>625</locationX>
        <locationY>1458</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Check_choices</targetReference>
        </connector>
        <fields>
            <name>Title2_0</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(8, 7, 7);&quot;&gt;Per concludere, invia al cliente promemoria per l&apos;appuntamento.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Email_screen_Privato_0_Section1</name>
            <fieldType>RegionContainer</fieldType>
            <fields>
                <name>Email_screen_Privato_0_Section1_Column1</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>Title1_0</name>
                    <fieldText>&lt;p&gt;&lt;span style=&quot;font-size: 16px; color: rgb(8, 7, 7);&quot;&gt;Si desidera utilizzare il seguente indirizzo email?&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 16px; color: rgb(8, 7, 7);&quot;&gt;{!Formula_ContactEmail}&lt;/span&gt;&lt;/p&gt;</fieldText>
                    <fieldType>DisplayText</fieldType>
                </fields>
                <fields>
                    <name>OpzioniImpresa</name>
                    <choiceReferences>Option_EmailCorretta_Si</choiceReferences>
                    <choiceReferences>Option_EmailCorretta_No</choiceReferences>
                    <dataType>String</dataType>
                    <fieldText>Selezionare un valore</fieldText>
                    <fieldType>RadioButtons</fieldType>
                    <isRequired>true</isRequired>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>12</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <isRequired>false</isRequired>
            <regionContainerType>SectionWithoutHeader</regionContainerType>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>Formula_ContactEmail</leftValueReference>
                    <operator>IsNull</operator>
                    <rightValue>
                        <booleanValue>false</booleanValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>Case2</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;font-size: 16px; background-color: rgb(255, 255, 255);&quot;&gt;Non risulta presente alcun indirizzo email certificato associato al cliente, di conseguenza si consiglia di utilizzare l&apos;indirizzo email di uno dei referenti d&apos;impresa disponibili.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>Formula_ContactEmail</leftValueReference>
                    <operator>IsNull</operator>
                    <rightValue>
                        <booleanValue>true</booleanValue>
                    </rightValue>
                </conditions>
                <conditions>
                    <leftValueReference>ReferentiImpresa_Size</leftValueReference>
                    <operator>GreaterThan</operator>
                    <rightValue>
                        <numberValue>0.0</numberValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>Email_screen_Privato_0_Section2</name>
            <fieldType>RegionContainer</fieldType>
            <fields>
                <name>Email_screen_Privato_0_Section2_Column1</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>SelezionaReferenteTitle</name>
                    <fieldText>&lt;p&gt;&lt;span style=&quot;font-size: 16px; background-color: rgb(255, 255, 255);&quot;&gt;Selezionare il referente d&apos;impresa al cui indirizzo email inviare la comunicazione:&lt;/span&gt;&lt;/p&gt;</fieldText>
                    <fieldType>DisplayText</fieldType>
                    <visibilityRule>
                        <conditionLogic>and</conditionLogic>
                        <conditions>
                            <leftValueReference>ReferentiImpresa_Size</leftValueReference>
                            <operator>GreaterThan</operator>
                            <rightValue>
                                <numberValue>0.0</numberValue>
                            </rightValue>
                        </conditions>
                    </visibilityRule>
                </fields>
                <fields>
                    <name>ReferentiImpresa</name>
                    <extensionName>builder_industries_insurance:fscSinglTbl</extensionName>
                    <fieldType>ComponentInstance</fieldType>
                    <inputParameters>
                        <name>fieldsToQuery</name>
                        <value>
                            <elementReference>List_ReferentiImpresa_Labels</elementReference>
                        </value>
                    </inputParameters>
                    <inputParameters>
                        <name>inputRecordIds</name>
                        <value>
                            <elementReference>List_ReferentiImpresa_Ids</elementReference>
                        </value>
                    </inputParameters>
                    <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
                    <isRequired>true</isRequired>
                    <storeOutputAutomatically>true</storeOutputAutomatically>
                    <visibilityRule>
                        <conditionLogic>and</conditionLogic>
                        <conditions>
                            <leftValueReference>ReferentiImpresa_Size</leftValueReference>
                            <operator>GreaterThan</operator>
                            <rightValue>
                                <numberValue>0.0</numberValue>
                            </rightValue>
                        </conditions>
                    </visibilityRule>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>12</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <isRequired>false</isRequired>
            <regionContainerType>SectionWithoutHeader</regionContainerType>
            <visibilityRule>
                <conditionLogic>or</conditionLogic>
                <conditions>
                    <leftValueReference>OpzioniImpresa</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <elementReference>Option_EmailCorretta_No</elementReference>
                    </rightValue>
                </conditions>
                <conditions>
                    <leftValueReference>Formula_ContactEmail</leftValueReference>
                    <operator>IsNull</operator>
                    <rightValue>
                        <booleanValue>true</booleanValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>Email_screen_Privato_0_Section3</name>
            <fieldType>RegionContainer</fieldType>
            <fields>
                <name>Email_screen_Privato_0_Section3_Column1</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>Case3</name>
                    <fieldText>&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);&quot;&gt;Non risulta presente alcun indirizzo email certificato associato al cliente e non è stato censito alcun referente d&apos;impresa.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);&quot;&gt;Si desidera procedere con l&apos;inserimento di un nuovo referente?&lt;/span&gt;&lt;/p&gt;</fieldText>
                    <fieldType>DisplayText</fieldType>
                    <visibilityRule>
                        <conditionLogic>and</conditionLogic>
                        <conditions>
                            <leftValueReference>Formula_ContactEmail</leftValueReference>
                            <operator>IsNull</operator>
                            <rightValue>
                                <booleanValue>true</booleanValue>
                            </rightValue>
                        </conditions>
                    </visibilityRule>
                </fields>
                <fields>
                    <name>Case4</name>
                    <fieldText>&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);&quot;&gt;Non risulta presente alcun referente d&apos;impresa sul cliente in oggetto.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);&quot;&gt;Si desidera procedere con l&apos;inserimento di un nuovo referente?&lt;/span&gt;&lt;/p&gt;</fieldText>
                    <fieldType>DisplayText</fieldType>
                    <visibilityRule>
                        <conditionLogic>and</conditionLogic>
                        <conditions>
                            <leftValueReference>OpzioniImpresa</leftValueReference>
                            <operator>EqualTo</operator>
                            <rightValue>
                                <elementReference>Option_EmailCorretta_No</elementReference>
                            </rightValue>
                        </conditions>
                    </visibilityRule>
                </fields>
                <fields>
                    <name>OpzioniReferentiImpresa</name>
                    <choiceReferences>NuovoRefImpresa_SI</choiceReferences>
                    <choiceReferences>NuovoRefImpresa_NO</choiceReferences>
                    <dataType>String</dataType>
                    <fieldText>Selezionare un valore</fieldText>
                    <fieldType>RadioButtons</fieldType>
                    <isRequired>false</isRequired>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>12</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <isRequired>false</isRequired>
            <regionContainerType>SectionWithoutHeader</regionContainerType>
            <visibilityRule>
                <conditionLogic>(1 OR 3) AND  2</conditionLogic>
                <conditions>
                    <leftValueReference>Formula_ContactEmail</leftValueReference>
                    <operator>IsNull</operator>
                    <rightValue>
                        <booleanValue>true</booleanValue>
                    </rightValue>
                </conditions>
                <conditions>
                    <leftValueReference>ReferentiImpresa_Size</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <numberValue>0.0</numberValue>
                    </rightValue>
                </conditions>
                <conditions>
                    <leftValueReference>OpzioniImpresa</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <elementReference>Option_EmailCorretta_No</elementReference>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>NuovoRefImpresaNo</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); font-size: 16px;&quot;&gt;Si consiglia di aggiornare l&apos;informazione in Anagrafe e successivamente di riavviare la procedura.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>OpzioniReferentiImpresa</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <elementReference>NuovoRefImpresa_NO</elementReference>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>Email_screen_Privato_0_Section4</name>
            <fieldType>RegionContainer</fieldType>
            <fields>
                <name>Email_screen_Privato_0_Section4_Column1</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>NDGRefImpresa</name>
                    <dataType>String</dataType>
                    <fieldText>NDG</fieldText>
                    <fieldType>InputField</fieldType>
                    <isRequired>false</isRequired>
                </fields>
                <fields>
                    <name>NomeRefImpresa</name>
                    <dataType>String</dataType>
                    <fieldText>Nome</fieldText>
                    <fieldType>InputField</fieldType>
                    <isRequired>false</isRequired>
                </fields>
                <fields>
                    <name>CognomeRefImpresa</name>
                    <dataType>String</dataType>
                    <fieldText>Cognome</fieldText>
                    <fieldType>InputField</fieldType>
                    <isRequired>true</isRequired>
                </fields>
                <fields>
                    <name>AmbitoRefImpresa</name>
                    <dataType>String</dataType>
                    <fieldText>Ambito</fieldText>
                    <fieldType>InputField</fieldType>
                    <isRequired>false</isRequired>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>6</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <fields>
                <name>Email_screen_Privato_0_Section4_Column2</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>PhoneRefImpresa</name>
                    <extensionName>flowruntime:phone</extensionName>
                    <fieldType>ComponentInstance</fieldType>
                    <inputParameters>
                        <name>label</name>
                        <value>
                            <stringValue>Telefono</stringValue>
                        </value>
                    </inputParameters>
                    <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
                    <isRequired>true</isRequired>
                    <storeOutputAutomatically>true</storeOutputAutomatically>
                </fields>
                <fields>
                    <name>MobileRefImpresa</name>
                    <extensionName>flowruntime:phone</extensionName>
                    <fieldType>ComponentInstance</fieldType>
                    <inputParameters>
                        <name>label</name>
                        <value>
                            <stringValue>Mobile</stringValue>
                        </value>
                    </inputParameters>
                    <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
                    <isRequired>true</isRequired>
                    <storeOutputAutomatically>true</storeOutputAutomatically>
                </fields>
                <fields>
                    <name>EmailRefImpresa</name>
                    <extensionName>flowruntime:email</extensionName>
                    <fieldType>ComponentInstance</fieldType>
                    <inputParameters>
                        <name>required</name>
                        <value>
                            <booleanValue>true</booleanValue>
                        </value>
                    </inputParameters>
                    <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
                    <isRequired>true</isRequired>
                    <storeOutputAutomatically>true</storeOutputAutomatically>
                </fields>
                <fields>
                    <name>NoteRefImpresa</name>
                    <fieldText>Note</fieldText>
                    <fieldType>LargeTextArea</fieldType>
                    <isRequired>false</isRequired>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>6</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <isRequired>false</isRequired>
            <regionContainerType>SectionWithoutHeader</regionContainerType>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>OpzioniReferentiImpresa</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <elementReference>NuovoRefImpresa_SI</elementReference>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <start>
        <locationX>50</locationX>
        <locationY>106</locationY>
        <connector>
            <targetReference>Get_NDG</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <variables>
        <name>appointmentEmail</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>Contatti</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contact</objectType>
    </variables>
    <variables>
        <name>List_ReferentiImpresa_Ids</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>List_ReferentiImpresa_Labels</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>accountID</description>
        <name>recordId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>ReferenteImpresa</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contact</objectType>
    </variables>
    <variables>
        <name>ReferentiImpresa_Size</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
</Flow>
